generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum DeliveryMethod {
  EMAIL
  PHYSICAL
}

model User {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  email       String   @unique
  name        String?
  image       String?
  provider    String
  providerId  String   @unique
  postcards   Postcard[]
}

model Postcard {
  id            String         @id @default(cuid())
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  user          User           @relation(fields: [userId], references: [id])
  userId        String
  templateKey   String
  content       String
  deliveryMethod DeliveryMethod
  status        String          @default("DRAFT")
  recipientName String?
  recipientEmail String?
  recipientAddressLine1 String?
  recipientAddressLine2 String?
  recipientCity String?
  recipientState String?
  recipientPostalCode String?
  recipientCountry String?
  deliveries    Delivery[]
}

model Delivery {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  postcard    Postcard @relation(fields: [postcardId], references: [id])
  postcardId  String
  type        String   // "EMAIL" or "PHYSICAL_PROVIDER_NAME"
  status      String   @default("PENDING")
  trackingCode String?
}
